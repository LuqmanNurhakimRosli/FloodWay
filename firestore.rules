rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // ── floodReports ──────────────────────────────────────────
    // Any authenticated user can read all reports.
    // Any authenticated user can create a report.
    // Only the report creator OR an admin can update/delete.
    // (For simplicity in this FYP, any auth user can update — moderator panel)
    match /floodReports/{reportId} {
      allow read:   if request.auth != null;
      allow create: if request.auth != null;
      allow update: if request.auth != null;
      allow delete: if request.auth != null;
    }

    // Deny everything else by default
    match /{document=**} {
      allow read, write: if false;
    }
  }
}
